/* stylelint-disable no-descending-specificity */

@error-border-color: #ff1f1f;
@error-background-color: #ffe7e7;

.mw-twocolconflict-split-header,
.mw-twocolconflict-special-your-version-header {
	margin-top: 20px;
}

.mw-twocolconflict-split-flex-header {
	display: flex;
	margin-bottom: 20px;
}

.mw-twocolconflict-special-your-version-header,
.mw-twocolconflict-split-current-version-header,
.mw-twocolconflict-split-your-version-header {
	flex: 1;
	text-align: center;

	.mw-twocolconflict-revision-label {
		font-weight: bold;
		padding: 0 5px;
	}
}

.mw-twocolconflict-split-current-version-header .mw-twocolconflict-revision-label {
	background-color: #ffe8a6;
}

.mw-twocolconflict-special-your-version-header .mw-twocolconflict-revision-label,
.mw-twocolconflict-split-your-version-header .mw-twocolconflict-revision-label {
	background-color: #add8ff;
}

.mw-twocolconflict-split-view {
	display: flex;
	flex-direction: column;
}

.mw-twocolconflict-single-row,
.mw-twocolconflict-split-row {
	display: flex;
	margin: 10px 0;
}

.mw-twocolconflict-split-row {
	align-items: flex-start;

	&.mw-twocolconflict-no-selection {
		background-color: @error-background-color;
		border: 2px solid @error-border-color;
		border-radius: 2px;
		margin: 5px -5px;
		padding: 3px;
	}
}

.mw-twocolconflict-single-column,
.mw-twocolconflict-split-column {
	flex: 1;
	background-color: #fff;
	color: #000;
	position: relative;
	// Same radius as in MediaWiki core's diff.css
	border-radius: 0.33em;
	border-width: 2px 2px 2px 6px;
	border-style: solid;
	padding: 5px 40px 5px 20px;
	min-height: 50px;
	white-space: pre-line;
	overflow-wrap: break-word;
	min-width: 0;

	&.mw-twocolconflict-split-add {
		border-color: #add8ff;
	}

	&.mw-twocolconflict-split-delete {
		border-color: #ffe8a6;
	}

	&.mw-twocolconflict-split-copy {
		border-color: #e9e9e9;
		background-color: #fafafa;
	}

	ins.mw-twocolconflict-diffchange {
		background-color: #add8ff;
	}

	del.mw-twocolconflict-diffchange {
		background-color: #ffe8a6;
	}

	ins.mw-twocolconflict-diffchange,
	del.mw-twocolconflict-diffchange {
		text-decoration: none;
	}

	&.mw-twocolconflict-split-unselected {
		color: #72777d;

		&.mw-twocolconflict-split-add {
			border-color: #eaf3ff;
		}

		&.mw-twocolconflict-split-delete {
			border-color: #fef6e7;
		}

		ins.mw-twocolconflict-diffchange {
			background-color: #eaf3ff;
		}

		del.mw-twocolconflict-diffchange {
			background-color: #fef6e7;
		}

		.oo-ui-widget-disabled > .oo-ui-buttonElement-button > .oo-ui-iconElement-icon {
			// Should be @wmui-color-base50 (#a2a9b1), but we can't set the color on an SVG
			opacity: 0.34;
		}
	}

	.mw-twocolconflict-split-edit-button {
		position: absolute;
		top: 0;
		right: 0;
	}

	.mw-twocolconflict-split-save-button {
		display: none;
		position: absolute;
		top: 0;
		right: 0;
	}

	.mw-twocolconflict-split-reset-button {
		display: none;
		position: absolute;
		top: 30px;
		right: 0;
	}

	.mw-twocolconflict-split-reset-diff-text {
		display: none;
	}

	.mw-twocolconflict-split-collapse-button,
	.mw-twocolconflict-split-expand-button {
		bottom: 0;
		position: absolute;
		right: 0;
	}

	.mw-twocolconflict-split-collapsed {
		max-height: 80px;
		overflow: hidden;

		.mw-twocolconflict-split-fade {
			background-image: linear-gradient( transparent, #fafafa );
			border-radius: 8px;
			bottom: 0;
			height: 50px;
			left: 0;
			pointer-events: none; // Allows clicking "through" the element
			position: absolute;
			width: 100%;
		}

		.mw-twocolconflict-split-collapse-button {
			display: none;
		}
	}

	.mw-twocolconflict-split-expanded {
		.mw-twocolconflict-split-expand-button {
			display: none;
		}
	}

	.mw-twocolconflict-split-expand-button:last-child {
		// OOUI default override
		margin-right: 0.5em;
	}
}

.mw-twocolconflict-split-column {
	&.mw-twocolconflict-split-delete {
		margin-right: 10px;
	}

	&.mw-twocolconflict-split-add {
		margin-left: 10px;
	}
}

.mw-twocolconflict-split-selector-label {
	margin-bottom: -8px;
	text-align: center;

	span {
		display: inline-block;
		line-height: 1.2em;
		width: 110px;
	}

	.mw-twocolconflict-no-selection & {
		color: @error-border-color;
	}
}

.mw-twocolconflict-split-selection {
	display: flex;
	margin-top: 10px;
	margin-left: auto;
	margin-right: auto;
	width: 66px;

	> div {
		flex: 1;
	}

	.mw-twocolconflict-split-row.mw-twocolconflict-no-selection & > div {
		.oo-ui-radioInputWidget [ type='radio' ] + span {
			border-color: @error-border-color;
		}
	}

	> div:nth-child( 1 ) {
		.oo-ui-radioInputWidget.oo-ui-widget-enabled [ type='radio' ]:checked + span,
		.oo-ui-radioInputWidget.oo-ui-widget-enabled [ type='radio' ]:active + span,
		.oo-ui-radioInputWidget [ type='radio' ] + span {
			border-color: #ac6700;
			background: #fef7e7;
		}
	}

	> div:nth-child( 2 ) {
		text-align: right;

		.oo-ui-radioInputWidget.oo-ui-widget-enabled [ type='radio' ]:checked + span,
		.oo-ui-radioInputWidget.oo-ui-widget-enabled [ type='radio' ]:active + span,
		.oo-ui-radioInputWidget [ type='radio' ] + span {
			border-color: #2c529d;
			background: #ebf3fe;
		}
	}
}

.mw-twocolconflict-messageWidget.oo-ui-messageWidget:enabled {
	& + & {
		margin-top: 16px;
	}
}

.mw-twocolconflict-copy-notice {
	padding: 3em 0;

	p {
		margin: 1em;
		font-size: 0.875em;
	}
}

.client-nojs {
	.mw-twocolconflict-split-edit-button,
	.mw-twocolconflict-split-expand-button {
		display: none;
	}

	/* stylelint-disable-next-line selector-max-id */
	#wpPreviewWidget {
		display: none;
	}

	.mw-twocolconflict-split-flex-header {
		.mw-twocolconflict-split-selection-container {
			display: none;
		}
	}

	.mw-twocolconflict-your-text {
		display: none;
	}
}

.client-js {
	.mw-twocolconflict-overview {
		// We hide these messages because JavaScript users have access to an interactive tour:
		// twocolconflict-split-header-overview
		// twocolconflict-talk-header-overview
		display: none;
	}

	.mw-twocolconflict-your-text {
		position: absolute;
		left: -9999px;
		height: 0;
	}
}
